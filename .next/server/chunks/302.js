"use strict";exports.id=302,exports.ids=[302],exports.modules={302:(e,t,l)=>{l.d(t,{parseFactorsTable1:()=>o});var r=l(3751);function s(e){if(!e)return null;let t=e.replace(/\u00a0/g," ").trim();if(!t)return null;let l=t.match(/^([+-])?\s*([\d,]+)$/);if(!l)return null;let r="-"===l[1]?-1:1,s=Number(l[2].replace(/,/g,""));return Number.isFinite(s)?r*s:null}function a(e){if(!e)return null;let t=e.match(/([A-Z][a-z]{2,})\s+(\d{1,2}),\s+(\d{4})/);if(!t)return null;let l={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"}[t[1]];if(!l)return null;let r=String(t[2]).padStart(2,"0"),s=t[3];return`${s}-${l}-${r}`}function n(e){let t={RBC:"연준 신용",SECURITIES_HELD:"보유 증권",TREASURY:"미 국채",BILLS:"단기채",NOTES_BONDS:"중장기채",TIPS:"물가연동채",MBS:"주택저당증권",REPOS:"레포",LOANS:"대출",BTFP:"은행기간대출",SWAPS:"통화스왑",GOLD:"금",SDR:"SDR 증서",CURRENCY:"유통 통화",RRP:"역레포",DEPOSITS:"연준 예치금",TGA:"재무부 일반계정"};if(t[e])return t[e];let l={"Reserve Bank credit":"연준 신용","Securities held outright":"보유 증권","U.S. Treasury securities":"미 국채",Bills:"단기채","Notes and bonds":"중장기채",TIPS:"물가연동채","Mortgage-backed securities":"주택저당증권","Repurchase agreements":"레포",Loans:"대출","Primary credit":"1차 신용","Bank Term Funding Program":"은행기간대출",BTFP:"은행기간대출","Central bank liquidity swaps":"통화스왑",Gold:"금",SDR:"SDR 증서","Reverse repurchase agreements":"역레포","Currency in circulation":"유통 통화","U.S. Treasury, General Account":"재무부 일반계정","Deposits with F.R. Banks, other than reserve balances":"연준 예치금","Other liabilities and capital":"연준 예치금","Reserve balances with Federal Reserve Banks":"지급준비금"};if(l[e])return l[e];for(let[t,r]of Object.entries(l))if(e.toLowerCase().includes(t.toLowerCase())||t.toLowerCase().includes(e.toLowerCase()))return r;return e}async function o(e,t){let l=r.zD(e),o=[];l("table").each((e,t)=>{let r=l(t),a=r.text().toLowerCase();if(a.includes("factors affecting reserve balances")||a.includes("reserve bank credit")){let e=[];r.find("thead tr, tr:first-child").first().find("th, td").each((t,r)=>{let s=l(r).text().trim();s&&e.push(s)}),r.find("tbody tr, tr").each((e,t)=>{let r=l(t),a=r.find("td, th");if(0===a.length)return;let n=r.find("td:first-child, th:first-child").text().trim();if(!n||n.length<3)return;let i=[];a.slice(1).each((e,t)=>{let r=s(l(t).text().trim());null!==r&&i.push(r)}),n&&i.length>0&&o.push({label:n,values:i})})}});let c=l("body").text().replace(/\r/g,""),u=c.split("\n").map(e=>e.replace(/\u00a0/g," ").trim()).filter(Boolean),d=a((u.find(e=>e.startsWith("Release Date:"))??"").replace("Release Date:","").trim())||"",f="";for(let e=0;e<u.length;e++){let t=u[e];if(t.includes("Week ended")&&!t.toLowerCase().includes("change from")){let e=t.match(/Week\s+ended\s+([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);if(e){f=e[1].trim();break}}}let g=a(f)||"";if(-1===c.toLowerCase().indexOf("factors affecting reserve balances")){let e=!1;for(let t of["reserve bank credit","table 1","factors supplying","factors absorbing"]){let l=c.toLowerCase().indexOf(t);if(-1!==l){console.warn(`[parseFactorsTable1] Table 1 not found with primary keyword, but found "${t}" at index ${l}`),e=!0;break}}if(!e)throw console.error("[parseFactorsTable1] Table 1 section not found. Text length:",c.length),console.error("[parseFactorsTable1] First 1000 chars of text:",c.substring(0,1e3)),Error('Table 1 "Factors Affecting Reserve Balances" not found in HTML')}let h=-1,p=-1,b=-1,m=-1,w="",y="";for(let e=0;e<u.length;e++){let t=u[e].toLowerCase();if(t.includes("week ended")&&t.includes("change from")){h=e;let t=u[e].split(/\s{2,}|\t/).map(e=>e.trim()).filter(Boolean);for(let l=0;l<t.length;l++){let r=t[l].toLowerCase();if(r.includes("week ended")&&!r.includes("change"))p=l,u[e].match(/Week\s+ended\s+([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);else if(r.includes("change from week ended")){b=l;let t=u[e].match(/Change\s+from\s+week\s+ended:\s*([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);t&&(w=t[1].trim())}else if((r.includes("change from:")||r.includes("change from"))&&b>=0&&l>b){m=l;let t=u[e].match(/Change\s+from:\s*([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);t&&(y=t[1].trim())}}break}}if(-1===h){console.warn("[parseFactorsTable1] Header not found with standard pattern, trying flexible search...");for(let e=0;e<Math.min(300,u.length);e++){let t=u[e],l=t.toLowerCase();if(l.includes("week")||l.includes("change")){let l=[e>0?u[e-1]:"",t,e+1<u.length?u[e+1]:""].join(" ").toLowerCase();if(l.includes("week")&&l.includes("change")){h=e,p=0,b=1,m=2;let l=[e>0?u[e-1]:"",t,e+1<u.length?u[e+1]:""].join(" ");l.match(/Week\s+ended\s+([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);let r=l.match(/Change\s+from\s+week\s+ended[:\s]+([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i),s=l.match(/Change\s+from[:\s]+([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);r&&(w=r[1].trim()),s&&(y=s[1].trim()),console.log(`[parseFactorsTable1] Found header at line ${e} with flexible search`);break}}}}if(-1===h){console.error("[parseFactorsTable1] Header not found. Searching in lines:",{totalLines:u.length,sampleLines:u.slice(0,100)});let e=[];for(let t=0;t<Math.min(200,u.length);t++){let l=u[t].toLowerCase();(l.includes("week")||l.includes("change")||l.includes("ended"))&&e.push({line:t,text:u[t]})}console.error("[parseFactorsTable1] Potential header lines:",e.slice(0,20)),console.warn("[parseFactorsTable1] Header not found, using default column indices"),h=0,p=0,b=1,m=2}let T=a(w)||"";console.log("[parseFactorsTable1] Header found at line",h,{weekEndedColIndex:p,changeFromWeekEndedColIndex:b,changeFromYearAgoColIndex:m,prevWeekEndedText:w,yearAgoLabel:y});let v=[],S=(e,t=0)=>{for(let l=t;l<u.length;l++)if(u[l]===e)return l;let l=e.toLowerCase();for(let e=t;e<u.length;e++)if(u[e].toLowerCase()===l)return e;let r=l.split(/[,\s]+/).filter(e=>e.length>3);for(let e=t;e<u.length;e++){let t=u[e].toLowerCase();if(r.every(e=>t.includes(e)))return e}return -1},R=S("Reserve Bank credit",h+1);-1===R&&(R=S("Reserve bank credit",h+1));let F=S("Total factors supplying reserve funds",R>=0?R:h+1);if(-1===F&&(F=S("Total factors supplying",R>=0?R:h+1)),-1===R)throw console.error("[parseFactorsTable1] Supplying factors section not found. Searching for keywords:",{headerLineIndex:h,linesAroundHeader:u.slice(Math.max(0,h-5),Math.min(h+50,u.length))}),Error('Supplying factors section not found. Expected "Reserve Bank credit" after header');for(let e of(console.log(`[parseFactorsTable1] Supplying factors section: ${R} to ${F>0?F:"end"}`),console.log(`[parseFactorsTable1] Parsing supplying factors from line ${R} to ${F>0?F:u.length}`),["Reserve Bank credit","Securities held outright","U.S. Treasury securities","Bills","Notes and bonds","Notes and bonds, nominal","Notes and bonds, inflation-indexed","Inflation compensation","Federal agency debt securities","Mortgage-backed securities","Unamortized premiums on securities held outright","Unamortized discounts on securities held outright","Repurchase agreements","Loans","Primary credit","Secondary credit","Seasonal credit","Paycheck Protection Program Liquidity Facility","Bank Term Funding Program","Other credit extensions","Net portfolio holdings of MS Facilities 2020 LLC","Float","Central bank liquidity swaps","Other Federal Reserve assets","Gold Stock","Special Drawing Rights Certificate Account","Treasury Currency Outstanding"])){let t=R,l=F>0?F:Math.min(R+200,u.length),r=S(e,t);if(r<0||r>=l||e.toLowerCase().includes("total factors supplying"))continue;let a=0,o=0,i=0,c=[];for(let e=1;e<=5&&r+e<u.length;e++){let t=s(u[r+e]);null!==t&&c.push(t)}c.length>=1&&(a=c[0],o=c.length>=2?c[1]:0,i=c.length>=3?c[2]:0,v.push({key:e,labelKo:n(e),value:a,wow:o,yoy:i}),console.log(`[parseFactorsTable1] Added supplying factor: ${e} = ${a} (wow: ${o}, yoy: ${i})`))}console.log(`[parseFactorsTable1] Parsed ${v.length} supplying factors (before whitelist filter)`);let k=["RBC","SECURITIES_HELD","TREASURY","BILLS","NOTES_BONDS","TIPS","MBS","REPOS","LOANS","BTFP","SWAPS","GOLD","SDR"],C=e=>{let t=e.replace(/\u00a0/g," ").replace(/[()]/g," ").replace(/\./g," ").replace(/\s+/g," ").toLowerCase().trim();return t.includes("reserve bank credit")||t.includes("연준 신용")?"RBC":t.includes("securities held outright")||t.includes("보유 증권")?"SECURITIES_HELD":(t.includes("treasury")||t.includes("국채"))&&!t.includes("general")&&!t.includes("account")?"TREASURY":t.includes("bills")||t.includes("단기채")?"BILLS":t.includes("notes")&&t.includes("bonds")||t.includes("중장기채")?t.includes("inflation")||t.includes("tips")?"TIPS":"NOTES_BONDS":t.includes("tips")||t.includes("inflation")||t.includes("물가연동채")?"TIPS":t.includes("mbs")||t.includes("mortgage")||t.includes("주택저당증권")?"MBS":(t.includes("repo")||t.includes("repurchase"))&&!t.includes("reverse")&&!t.includes("레포")?"REPOS":t.includes("loans")||t.includes("대출")?t.includes("primary credit")||t.includes("1차 신용")?"LOANS":t.includes("btfp")||t.includes("bank term funding")||t.includes("은행기간대출")?"BTFP":"LOANS":t.includes("btfp")||t.includes("bank term funding program")||t.includes("은행기간대출")?"BTFP":t.includes("swap")||t.includes("통화스왑")?"SWAPS":t.includes("gold")||t.includes("금")?"GOLD":t.includes("sdr")||t.includes("special drawing rights")||t.includes("sdr 증서")?"SDR":null},L=new Map,B=[];for(let e of v){let t=C(e.key);if(!t||!k.includes(t)){B.push(e.key);continue}let l=L.get(t);l&&(0!==l.value||0===e.value)||L.set(t,{...e,key:t})}let P=[];for(let e of k){let t=L.get(e);t&&P.push({...t,labelKo:n(e)})}console.log(`[parseFactorsTable1] Filtered supplying: ${P.length} items (expected: 13)`),B.length;let A=0,$=0,x=0;if(F>=0){let e=u[F],t=i(e);t.length>=1?console.log(`[parseFactorsTable1] Parsed "Total factors supplying reserve funds" from line ${F}:`,{value:A=t[0]||0,wow:$=t.length>=2&&t[1]||0,yoy:x=t.length>=3&&t[2]||0,lineText:e.substring(0,200)}):console.warn('[parseFactorsTable1] Failed to extract numbers from "Total factors supplying reserve funds" line:',e.substring(0,200))}else console.warn('[parseFactorsTable1] "Total factors supplying reserve funds" line not found');let O=[],E=F>=0?F+1:u.length,D=-1,M=-1,N=-1;for(let e=E;e<Math.min(E+100,u.length);e++){let t=u[e].toLowerCase();if(t.includes("continued")||t.includes("table 1 (continued)")){N=e;break}}let I=N>=0?Math.min(E,N):E;for(let e of(-1===(D=S("Total factors, other than reserve balances, absorbing reserve funds",I))&&(D=S("Total factors absorbing",I)),M=S("Reserve balances with Federal Reserve Banks",I),console.log(`[parseFactorsTable1] Absorbing factors section: ${I} to ${D>0?D:"end"}, Reserve balances at: ${M}`),console.log(`[parseFactorsTable1] Parsing absorbing factors from line ${I} to ${D>0?D:u.length}`),["Currency in circulation","Reverse repurchase agreements","Reverse repurchase agreements with foreign official and international accounts","Reverse repurchase agreements with others","Treasury Cash Holdings","Deposits with F.R. Banks, other than reserve balances","U.S. Treasury, General Account","Foreign official","Other","Other liabilities and capital"])){let t=D>0?D:Math.min(I+200,u.length),l=S(e,I);if(l<0||l>=t||e.toLowerCase().includes("total factors")||e.toLowerCase().includes("reserve balances"))continue;let r=[];for(let e=1;e<=5&&l+e<u.length;e++){let t=s(u[l+e]);null!==t&&r.push(t)}if(r.length>=1){let t=r[0],l=r.length>=2?r[1]:0,s=r.length>=3?r[2]:0;O.push({key:e,labelKo:n(e),value:t,wow:l,yoy:s}),console.log(`[parseFactorsTable1] Added absorbing factor: ${e} = ${t} (wow: ${l}, yoy: ${s})`)}}console.log(`[parseFactorsTable1] Parsed ${O.length} absorbing factors (before whitelist filter)`);let U=["CURRENCY","RRP","DEPOSITS","TGA"],z=e=>{let t=e.replace(/\u00a0/g," ").replace(/[()]/g," ").replace(/\./g," ").replace(/\s+/g," ").toLowerCase().trim();return t.includes("currency in circulation")||t.includes("유통 통화")?"CURRENCY":t.includes("reverse")&&t.includes("repo")||t.includes("역레포")?"RRP":t.includes("deposits")||t.includes("other liabilities")||t.includes("예치금")?t.includes("treasury")&&t.includes("general")?null:"DEPOSITS":t.includes("treasury")&&t.includes("general")||t.includes("tga")||t.includes("재무부 일반계정")?"TGA":null},G=new Map,H=[];for(let e of O){let t=z(e.key);if(!t||!U.includes(t)){H.push(e.key);continue}let l=G.get(t);l&&(0!==l.value||0===e.value)||G.set(t,{...e,key:t})}let W=[];for(let e of U){let t=G.get(e);t&&W.push({...t,labelKo:n(e)})}console.log(`[parseFactorsTable1] Filtered absorbing: ${W.length} items (expected: 4)`),H.length;let Z=0,Y=0,_=0;if(D>=0){let e=u[D],t=i(e);t.length>=1?console.log(`[parseFactorsTable1] Parsed "Total factors, other than reserve balances, absorbing reserve funds" from line ${D}:`,{value:Z=t[0]||0,wow:Y=t.length>=2&&t[1]||0,yoy:_=t.length>=3&&t[2]||0,lineText:e.substring(0,200)}):console.warn('[parseFactorsTable1] Failed to extract numbers from "Total factors absorbing" line:',e.substring(0,200))}else console.warn('[parseFactorsTable1] "Total factors, other than reserve balances, absorbing reserve funds" line not found');let K=0,j=0,q=0;if(M>=0){let e=u[M],t=i(e);t.length>=1?console.log(`[parseFactorsTable1] Parsed "Reserve balances with Federal Reserve Banks" from line ${M}:`,{value:K=t[0]||0,wow:j=t.length>=2&&t[1]||0,yoy:q=t.length>=3&&t[2]||0,lineText:e.substring(0,200)}):console.warn('[parseFactorsTable1] Failed to extract numbers from "Reserve balances" line:',e.substring(0,200))}else console.warn('[parseFactorsTable1] "Reserve balances with Federal Reserve Banks" line not found');let J={value:P.reduce((e,t)=>e+t.value,0),wow:P.reduce((e,t)=>e+t.wow,0),yoy:P.reduce((e,t)=>e+t.yoy,0)},Q={value:W.reduce((e,t)=>e+t.value,0),wow:W.reduce((e,t)=>e+t.wow,0),yoy:W.reduce((e,t)=>e+t.yoy,0)},V={value:A-Z},X=Math.abs(J.value-A);X>100&&console.warn("[parseFactorsTable1] Total supplying mismatch (calculated vs source):",{calculated:J.value,fromSource:A,delta:X});let ee=Math.abs(Q.value-Z);ee>100&&console.warn("[parseFactorsTable1] Total absorbing mismatch (calculated vs source):",{calculated:Q.value,fromSource:Z,delta:ee});let et=Math.abs(V.value-K);et>10&&console.warn("[parseFactorsTable1] Reserve balances mismatch (calculated vs source):",{calculated:V.value,fromSource:K,delta:et}),console.log("[parseFactorsTable1] Final totals (from source):",{totalSupplying:{value:A,wow:$,yoy:x},totalAbsorbing:{value:Z,wow:Y,yoy:_},reserveBalances:{value:K,wow:j,yoy:q},calculatedReserveBalances:V.value,reserveBalancesDelta:et});let el=A-Z,er=Math.abs(el-K),es=er<=10;return es||console.warn("[parseFactorsTable1] Reserve balances integrity check failed:",{calculated:el,fromSource:K,delta:er}),{releaseDate:d,weekEnded:g,prevWeekEnded:T,yearAgoLabel:y,supplying:P,absorbing:W,totals:{totalSupplying:{value:A,wow:$,yoy:x},totalAbsorbingExReserves:{value:Z,wow:Y,yoy:_},reserveBalances:{value:K,wow:j,yoy:q}},integrity:{calcReserveBalances:el,delta:er,ok:es}}}function i(e){let t;let l=[],r=/([+-]?\s*[\d,]+(?:\.[\d]+)?)/g,a=[];for(;null!==(t=r.exec(e));){let e=s(t[1]);null!==e&&a.push(e)}if(a.length>0)return a;for(let t of e.split(/\s{2,}|\t/).map(e=>e.trim()).filter(Boolean)){let e=s(t);null!==e&&l.push(e)}return l}}};