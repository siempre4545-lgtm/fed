"use strict";exports.id=302,exports.ids=[302],exports.modules={302:(e,t,l)=>{l.d(t,{parseFactorsTable1:()=>o});var r=l(3751);function s(e){if(!e)return null;let t=e.replace(/[\u00a0\s,]/g,"").trim();if(!t)return null;let l=t.match(/^([+-])?/),r=l&&"-"===l[1]?-1:1,s=t.match(/(\d+)/);if(!s)return null;let a=parseInt(s[1],10);return isNaN(a)?null:r*a}function a(e){if(!e)return null;let t=e.match(/([A-Z][a-z]{2,})\s+(\d{1,2}),\s+(\d{4})/);if(!t)return null;let l={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"}[t[1]];if(!l)return null;let r=String(t[2]).padStart(2,"0"),s=t[3];return`${s}-${l}-${r}`}function n(e){let t={"Reserve Bank credit":"연준 신용","Securities held outright":"보유 증권","U.S. Treasury securities":"미 국채",Bills:"단기채","Notes and bonds":"중장기채",TIPS:"물가연동채","Mortgage-backed securities":"주택저당증권","Repurchase agreements":"레포",Loans:"대출","Primary credit":"1차 신용","Bank Term Funding Program":"은행기간대출",BTFP:"은행기간대출","Central bank liquidity swaps":"통화스왑",Gold:"금",SDR:"SDR","Reverse repurchase agreements":"역레포","Currency in circulation":"유통 통화","U.S. Treasury, General Account":"TGA","Deposits with F.R. Banks, other than reserve balances":"예금 (지준금 제외)","Other liabilities and capital":"기타 부채\xb7자본","Reserve balances with Federal Reserve Banks":"지급준비금"};if(t[e])return t[e];for(let[l,r]of Object.entries(t))if(e.toLowerCase().includes(l.toLowerCase())||l.toLowerCase().includes(e.toLowerCase()))return r;return e}async function o(e,t){let l=r.zD(e),o=[];l("table").each((e,t)=>{let r=l(t),a=r.text().toLowerCase();if(a.includes("factors affecting reserve balances")||a.includes("reserve bank credit")){let e=[];r.find("thead tr, tr:first-child").first().find("th, td").each((t,r)=>{let s=l(r).text().trim();s&&e.push(s)}),r.find("tbody tr, tr").each((e,t)=>{let r=l(t),a=r.find("td, th");if(0===a.length)return;let n=r.find("td:first-child, th:first-child").text().trim();if(!n||n.length<3)return;let i=[];a.slice(1).each((e,t)=>{let r=s(l(t).text().trim());null!==r&&i.push(r)}),n&&i.length>0&&o.push({label:n,values:i})})}});let c=l("body").text().replace(/\r/g,""),d=c.split("\n").map(e=>e.replace(/\u00a0/g," ").trim()).filter(Boolean),f=a((d.find(e=>e.startsWith("Release Date:"))??"").replace("Release Date:","").trim())||"",u="";for(let e=0;e<d.length;e++){let t=d[e];if(t.includes("Week ended")&&!t.toLowerCase().includes("change from")){let e=t.match(/Week\s+ended\s+([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);if(e){u=e[1].trim();break}}}let h=a(u)||"";if(-1===c.toLowerCase().indexOf("factors affecting reserve balances")){let e=!1;for(let t of["reserve bank credit","table 1","factors supplying","factors absorbing"]){let l=c.toLowerCase().indexOf(t);if(-1!==l){console.warn(`[parseFactorsTable1] Table 1 not found with primary keyword, but found "${t}" at index ${l}`),e=!0;break}}if(!e)throw console.error("[parseFactorsTable1] Table 1 section not found. Text length:",c.length),console.error("[parseFactorsTable1] First 1000 chars of text:",c.substring(0,1e3)),Error('Table 1 "Factors Affecting Reserve Balances" not found in HTML')}let g=-1,p=-1,b=-1,m=-1,w="",y="";for(let e=0;e<d.length;e++){let t=d[e].toLowerCase();if(t.includes("week ended")&&t.includes("change from")){g=e;let t=d[e].split(/\s{2,}|\t/).map(e=>e.trim()).filter(Boolean);for(let l=0;l<t.length;l++){let r=t[l].toLowerCase();if(r.includes("week ended")&&!r.includes("change"))p=l,d[e].match(/Week\s+ended\s+([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);else if(r.includes("change from week ended")){b=l;let t=d[e].match(/Change\s+from\s+week\s+ended:\s*([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);t&&(w=t[1].trim())}else if((r.includes("change from:")||r.includes("change from"))&&b>=0&&l>b){m=l;let t=d[e].match(/Change\s+from:\s*([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);t&&(y=t[1].trim())}}break}}if(-1===g)for(let e=0;e<d.length;e++){let t=d[e];if(t.match(/Week\s+ended/i)&&t.match(/Change\s+from/i)){g=e,t.split(/\s{3,}/).map(e=>e.trim()).filter(Boolean),p=0,b=1,m=2,t.match(/Week\s+ended\s+([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);let l=t.match(/Change\s+from\s+week\s+ended[:\s]+([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i),r=t.match(/Change\s+from[:\s]+([A-Z][a-z]{2,}\s+\d{1,2},\s+\d{4})/i);l&&(w=l[1].trim()),r&&(y=r[1].trim());break}}if(-1===g){console.error("[parseFactorsTable1] Header not found. Searching in lines:",{totalLines:d.length,sampleLines:d.slice(0,50)});for(let e=0;e<Math.min(100,d.length);e++){let t=d[e].toLowerCase();(t.includes("week")||t.includes("change"))&&console.warn(`[parseFactorsTable1] Potential header at line ${e}:`,d[e])}throw Error('Table 1 header not found. Expected line with "Week ended" and "Change from"')}let k=a(w)||"";console.log("[parseFactorsTable1] Header found at line",g,{weekEndedColIndex:p,changeFromWeekEndedColIndex:b,changeFromYearAgoColIndex:m,prevWeekEndedText:w,yearAgoLabel:y});let T=[],v=["Reserve Bank credit","Reserve bank credit"],C=["Total factors supplying reserve funds","Total factors supplying"],L=-1,F=-1;for(let e=g+1;e<d.length;e++){let t=d[e];if(-1===L){for(let l of v)if(t.toLowerCase().includes(l.toLowerCase())){L=e;break}}if(L>=0&&-1===F){for(let l of C)if(t.toLowerCase().includes(l.toLowerCase())){F=e;break}}if(F>=0)break}if(-1===L)throw console.error("[parseFactorsTable1] Supplying factors section not found. Searching for keywords:",{headerLineIndex:g,linesAroundHeader:d.slice(Math.max(0,g-5),g+20)}),Error('Supplying factors section not found. Expected "Reserve Bank credit" after header');console.log(`[parseFactorsTable1] Parsing supplying factors from line ${L} to ${F>0?F:d.length}`);for(let e=L;e<(F>0?F:Math.min(L+100,d.length));e++){let t=d[e];if(!t.trim()||/^\s*[\d,\s+-]+\s*$/.test(t)||t.toLowerCase().includes("total factors supplying"))continue;let l=t.match(/^([^0-9+-]{3,}?)(?:\s{2,}|\t)/);if(l||(l=t.match(/^([A-Za-z][^0-9]{2,}?)(?=\s*[0-9+-])/)),!l&&e+1<d.length){let r=d[e+1];/^[\s]*[0-9+-]/.test(r)&&(l=[null,t.trim()])}if(!l)continue;let r=l[1]?.trim()||t.trim();if(!r||r.length<3)continue;let s=i(t);if(s.length<3&&e+1<d.length){let t=i(d[e+1]);t.length>0&&s.push(...t)}if(s.length>=3)T.push({key:r,labelKo:n(r),value:s[0]||0,wow:s[1]||0,yoy:s[2]||0}),console.log(`[parseFactorsTable1] Added supplying factor: ${r} = ${s[0]}`);else if(s.length>=1)T.push({key:r,labelKo:n(r),value:s[0]||0,wow:0,yoy:0}),console.log(`[parseFactorsTable1] Added supplying factor (partial): ${r} = ${s[0]}`);else if(e+1<d.length&&/^[\s]*[0-9+-]/.test(d[e+1])){let t=i(d[e+1]);t.length>=1&&(T.push({key:r,labelKo:n(r),value:t[0]||0,wow:t[1]||0,yoy:t[2]||0}),e++,console.log(`[parseFactorsTable1] Added supplying factor (multi-line): ${r} = ${t[0]}`))}}console.log(`[parseFactorsTable1] Parsed ${T.length} supplying factors`);let $=0,A=0,x=0;if(F>=0){let e=i(d[F]);e.length>=3&&($=e[0]||0,A=e[1]||0,x=e[2]||0)}let R=[],S=["Total factors, other than reserve balances, absorbing reserve funds","Total factors absorbing"],B=F>=0?F+1:d.length,z=-1,M=-1,Z=-1;for(let e=B;e<d.length;e++){let t=d[e].toLowerCase();if(t.includes("continued")||t.includes("table 1 (continued)")){Z=e;break}}let P=Z>=0?Math.min(B,Z):B;for(let e=P;e<d.length;e++){let t=d[e];if(-1===z){for(let l of S)if(t.toLowerCase().includes(l.toLowerCase())){z=e;break}}if(-1===M&&t.toLowerCase().includes("reserve balances with federal reserve banks")&&(M=e),z>=0&&M>=0)break}console.log(`[parseFactorsTable1] Parsing absorbing factors from line ${P} to ${z>0?z:d.length}`);for(let e=P;e<(z>0?z:Math.min(P+100,d.length));e++){let t=d[e];if(!t.trim()||/^\s*[\d,\s+-]+\s*$/.test(t)||t.toLowerCase().includes("continued")&&t.toLowerCase().includes("table")||t.toLowerCase().includes("total factors")||t.toLowerCase().includes("reserve balances"))continue;let l=t.match(/^([^0-9+-]{3,}?)(?:\s{2,}|\t)/);if(l||(l=t.match(/^([A-Za-z][^0-9]{2,}?)(?=\s*[0-9+-])/)),!l&&e+1<d.length){let r=d[e+1];/^[\s]*[0-9+-]/.test(r)&&(l=[null,t.trim()])}if(!l)continue;let r=l[1]?.trim()||t.trim();if(!r||r.length<3)continue;let s=i(t);if(s.length<3&&e+1<d.length){let t=i(d[e+1]);t.length>0&&s.push(...t)}if(s.length>=3)R.push({key:r,labelKo:n(r),value:s[0]||0,wow:s[1]||0,yoy:s[2]||0}),console.log(`[parseFactorsTable1] Added absorbing factor: ${r} = ${s[0]}`);else if(s.length>=1)R.push({key:r,labelKo:n(r),value:s[0]||0,wow:0,yoy:0}),console.log(`[parseFactorsTable1] Added absorbing factor (partial): ${r} = ${s[0]}`);else if(e+1<d.length&&/^[\s]*[0-9+-]/.test(d[e+1])){let t=i(d[e+1]);t.length>=1&&(R.push({key:r,labelKo:n(r),value:t[0]||0,wow:t[1]||0,yoy:t[2]||0}),e++,console.log(`[parseFactorsTable1] Added absorbing factor (multi-line): ${r} = ${t[0]}`))}}console.log(`[parseFactorsTable1] Parsed ${R.length} absorbing factors`);let D=0,W=0,E=0;if(z>=0){let e=i(d[z]);e.length>=3&&(D=e[0]||0,W=e[1]||0,E=e[2]||0)}let K=0,O=0,H=0;if(M>=0){let e=i(d[M]);e.length>=3&&(K=e[0]||0,O=e[1]||0,H=e[2]||0)}let N=$-D,G=Math.abs(N-K),J=G<=10;return J||console.warn("[parseFactorsTable1] Reserve balances mismatch:",{calculated:N,fromSource:K,delta:G}),{releaseDate:f,weekEnded:h,prevWeekEnded:k,yearAgoLabel:y,supplying:T,absorbing:R,totals:{totalSupplying:{value:$,wow:A,yoy:x},totalAbsorbingExReserves:{value:D,wow:W,yoy:E},reserveBalances:{value:K,wow:O,yoy:H}},integrity:{calcReserveBalances:N,delta:G,ok:J}}}function i(e){let t;let l=[],r=/([+-]?\s*[\d,]+(?:\.[\d]+)?)/g,a=[];for(;null!==(t=r.exec(e));){let e=s(t[1]);null!==e&&a.push(e)}if(a.length>0)return a;for(let t of e.split(/\s{2,}|\t/).map(e=>e.trim()).filter(Boolean)){let e=s(t);null!==e&&l.push(e)}return l}}};