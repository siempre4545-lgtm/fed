"use strict";(()=>{var e={};e.id=306,e.ids=[306],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7174:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>b,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>h});var o={};t.r(o),t.d(o,{GET:()=>u,dynamic:()=>l,revalidate:()=>p,runtime:()=>d});var a=t(9303),n=t(8716),s=t(670),i=t(7070);let l="force-dynamic",p=0,d="nodejs";async function u(e){try{let r=new URL(e.url),t=r.searchParams.get("from")??"",o=r.searchParams.get("to")??"",a="1"===r.searchParams.get("debug");if(!t||!o)return i.NextResponse.json({ok:!1,error:"from and to parameters are required (YYYY-MM-DD)"},{status:400});let n=r.origin,[s,l]=await Promise.all([fetch(`${n}/api/h41/report?date=${t}`,{cache:"no-store"}).then(e=>e.json()),fetch(`${n}/api/h41/report?date=${o}`,{cache:"no-store"}).then(e=>e.json())]);if(!s.ok||!l.ok)return i.NextResponse.json({ok:!1,error:"Failed to fetch one or both reports",fromError:s.error,toError:l.error},{status:500});let p=[];for(let e of l.tables||[]){let r=(s.tables||[]).find(r=>r.name===e.name);if(r)for(let t of e.rows||[]){let o=r.rows?.find(e=>e.label===t.label);if(o)for(let r of Object.keys(t).filter(e=>"number"==typeof t[e])){let a=o[r]||0,n=t[r]||0,s=n-a,i=0!==a?s/a*100:0;p.push({key:`${e.name}-${t.label}-${r}`,label:`${t.label} (${r})`,from:a,to:n,delta:s,deltaPercent:i,direction:s>0?"up":s<0?"down":"neutral"})}}}let d={ok:!0,from:{date:t,releaseDate:s.releaseDate,weekEnded:s.weekEnded},to:{date:o,releaseDate:l.releaseDate,weekEnded:l.weekEnded},comparisons:p,...a&&{meta:{comparedAt:new Date().toISOString(),comparisonCount:p.length,fromTableCount:s.tables?.length||0,toTableCount:l.tables?.length||0}}};return i.NextResponse.json(d,{headers:{"Cache-Control":"public, s-maxage=21600, stale-while-revalidate=86400"}})}catch(e){return console.error("Error in compare route:",e),i.NextResponse.json({ok:!1,error:e instanceof Error?e.message:String(e)},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/h41/compare/route",pathname:"/api/h41/compare",filename:"route",bundlePath:"app/api/h41/compare/route"},resolvedPagePath:"C:\\Users\\Dick\\FED_h.4.1\\h41-dashboard\\app\\api\\h41\\compare\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:f}=c,b="/api/h41/compare/route";function g(){return(0,s.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:h})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[276,972],()=>t(7174));module.exports=o})();